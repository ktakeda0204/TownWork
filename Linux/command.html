<!DOCTYPE html>
<html>
  <head>
    <title>Town workの旅</title>
    <meta charset="utf-8" />
    
    <link rel="stylesheet" href="../CSS/style.css">
  </head>

  
<body>
    <h2>Linuxコマンド</h2>
    <ul>
    <li><a href="#grep">grep</a></li>
    <li><a href="#head">head</a></li>
    <li><a href="#watch">watch</a></li>
    <li><a href="#tail">tail</a></li>
    <li><a href="#xargs">xargs</a></li>
    </ul>
    <p>パフォーマンスモニタリング系</p>
    <ul>
    <li><a href="#free">free</a></li>
    <li><a href="#vmstat">vmstat</a></li>
    </ul>

    <h3 id="grep">grep</h3>
    <ul>
    <li>-i：大文字小文字区別しない</li>
    <li>-o：一致した部分だけ抜き出せる。awkするよりこっちのが楽チンだったりする。</li>
    <li>-w：完全一致</li>
    </ul>

    <h3 id="head">head</h3>
    <li>-c：バイト数を指定できる。（使ったことないけど）</li>

    <h3 id="watch">watch</h3>
    なにか標準出力をモニタリングしたり、/proc/系のリアルタイムモニタリングのファイルの変化を見たり多種多様。
    <li>-n：実行間隔を秒単位で指定する</li>
    <li>-d：変化した部分を強調して表示してくれる</li>

    <h3 id="xargs">xargs</h3>
    パイプで渡されたファイル一覧を、指定したコマンドの引数に使用する事が出来る。
    しかし例えばunlinkは一度に一つの引数しかとれないので、lsをしてその結果をxargsを介して打ち込む事が出来ない。
    その様な時には
    <pre><code>
    ls | xargs -n 1 unlink
    </code></pre>
    とすればunlinkに一つずつ全てのファイルを引数として渡すことが出来る。

    
    
    <!-------------------------------------------------------------------->
    <h3 id="free">free</h3>
    メモリの空き容量を確認出来る。
    <pre><code>
    [server-admin@XXX]$ free -m
                 total       used       free     shared    buffers     cached
    Mem:         29508      26814       2693          5        425      18279
    -/+ buffers/cache:       8108      21399
    Swap:        10736          0      10736
    </code></pre>
    <ul>
    <li>total Mem：全メモリサイズ</li>
    <li>used Mem：使用しているメモリサイズ</li>
    <li>free Mem：空きのメモリサイズ</li>
    <li>buffers Mem：バッファ・キャッシュ領域</li>
    <li>cached Mem：ページ・キャッシュ領域</li>
    <li>free cahced：解放可能なキャッシュのサイズ</li>
    </ul>

    <h3 id="vmstat">vmstat</h3>
    PCのボトルネックを探索するのに便利。指定した間隔で各メモリの使用状況、I/Oの実行状態がモニタリングできる。
    <pre><code>
    procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----
    r  b  swpd   free   buff  cache   si   so    bi    bo   in      cs us sy id wa st
    </code></pre>
    <ul>
    <li>procs</li>
     <ul>
     <li>r：実行中と実行待ち中のプロセス数の合計</li>
     <li>b：割り込み不可能なスリープ状態にあるプロセス数。これが多いと何か待たされている。</li>
     </ul>

    <li>memory</li>
     <ul>
     <li>swpd：スワップ領域のサイズ</li>
     <li>free：空いているメモリー</li>
     <li>buff：</li>
     <li>cache：キャッシュに割り当てられたメモリーサイズ。</li>
     </ul>
    
    <li>swap</li>
     ここが頻繁に多いとメモリ不足が疑われる。
     <ul>
     <li>si：スワップインした回数。つまりディスクから一時的に読み込んでしまっている回数。</li>
     <li>so：スワップアウトした回数。つまりディスクに一時的に書き込んでしまっている回数。</li>
     </ul>
    
    <li>io</li>
     <ul>
     <li>bi：ブロックデバイスから受け取ったブロック数。なのでsiとも相関がある。純粋なDisk書き込みにも相関がある。</li>
     <li>bo：ブロックデバイスに送ったブロック数。</li>
     </ul>
    
    <li>cpu</li>
     <ul>
     <li>us：ユーザープログラムの処理に費やされた時間。これが多いとユーザープログラムが頑張れている。</li>
     <li>sy：カーネルコードの処理に費やされた時間の割合</li>
     <li>id：アイドル時間の割合</li>
     <li>wa：データの入出力処理（diskへのアクセス、ネットワークへのアクセス）の時間の割合</li>
     </ul>
    </ul>

  </body>
</html>

